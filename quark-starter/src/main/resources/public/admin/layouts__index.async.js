"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{52756:function($e,L,t){t.r(L);var Q=t(97857),R=t.n(Q),X=t(19632),h=t.n(X),Y=t(96695),S=t.n(Y),V=t(15009),M=t.n(V),w=t(99289),I=t.n(w),q=t(5574),m=t.n(q),f=t(67294),v=t(7837),ee=t(94740),te=t(3321),ne=t(85418),_e=t(33852),Ge=t.n(_e),ae=t(82925),se=t(53032),re=t(94785),D=t(7058),ue=t(66949),A=t(43083),T=t(91373),oe=t(87547),le=t(11247),ie=t(39711),l=t(85893),de=function(fe){var j,me=(0,v.useModel)("pageLoading"),ve=me.pageLoading,Ee=(0,f.useState)({}),b=m()(Ee,2),o=b[0],he=b[1],pe=(0,f.useState)({}),K=m()(pe,2),W=K[0],y=K[1],ce=(0,v.useModel)("pageLoading"),g=ce.setPageLoading,Pe=(0,v.useModel)("@@initialState"),C=Pe.initialState,d=C==null?void 0:C.accountInfo,p=(0,v.useLocation)(),E=re.Z.parse(p.search),Me=(0,f.useState)(""),B=m()(Me,2),De=B[0],k=B[1],ge=(0,f.useState)([]),Z=m()(ge,2),Oe=Z[0],O=Z[1],je=(0,f.useState)([""]),F=m()(je,2),x=F[0],U=F[1],ye=(0,f.useState)(!1),z=m()(ye,2),Ce=z[0],Ue=z[1],Le=(0,f.useState)([]),H=m()(Le,2),c=H[0],Re=H[1],Se=(0,f.useState)([]),$=m()(Se,2),Ie=$[0],Ae=$[1],Te=function(){var a=I()(M()().mark(function _(){var e,n,s,i;return M()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,v.request)("./config.json");case 2:if(e=r.sent,n=e.api.layout,n){r.next=7;break}return y("The layout API cannot be null!"),r.abrupt("return");case 7:return g(!0),r.next=10,(0,T.U)({url:n});case 10:s=r.sent,he(s),s.menu&&(Re(xe(s.menu)),Ae(ze((0,le.Z)(s.menu)))),i=(0,A.Ah)(s.menu,p.pathname,decodeURIComponent(P)),k(i),g(!1);case 16:case"end":return r.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),be=function(){var a=I()(M()().mark(function _(){var e,n,s;return M()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(e=(0,A.Ah)(o.menu,p.pathname,decodeURIComponent(P)),k(e),P){u.next=5;break}return y(null),u.abrupt("return");case 5:return n={},Object.keys(E).forEach(function(r){r!=="api"&&(n[r]=E[r])}),g(!0),u.next=10,(0,T.U)({url:P,data:n});case 10:s=u.sent,y(s),g(!1);case 13:case"end":return u.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),P="";E!=null&&E.api&&(P=E.api),(0,f.useEffect)(function(){Te()},[]),(0,f.useEffect)(function(){be()},[E.api]);var Ke=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o.menu,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],s=S()(e),i;try{for(s.s();!(i=s.n()).done;){var u=i.value,r=u.key;if(_===r)return O(h()(new Set(n))),n.push(r),U(h()(new Set(n))),u;if(u.routes&&u.routes.length>0){n.push(r);var J=a(_,u.routes,n);if(J)return O(h()(new Set(n))),U(h()(new Set(n))),J;n.pop()}}}catch(He){s.e(He)}finally{s.f()}},We=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(_.type===2)return _;if(!(!_.routes||!_.routes.length)){var n=S()(_.routes),s;try{for(n.s();!(s=n.n()).done;){var i=s.value;if(i.type===2)return i;if(i.routes&&i.routes.length>0){e.push(i.key);var u=a(i.routes[0]);if(u)return O(e),u;e.pop()}}}catch(r){n.e(r)}finally{n.f()}}},Be=function(_){var e=c.find(function(s){return s.key===_.key});if(e&&e.type!==3){if(e.type===1&&e.routes&&e.routes.length){var n=We(e);if(!n)return;U(h()(new Set([].concat(h()(x),[n.key])))),v.history.push(n.path)}else if(e.type===2){if(e.is_link===1||e.isLink===1)return window.open(e.path,"_blank"),!1;v.history.push(e.path)}}},ke=function(_){O(_)},Ze=o==null||(j=o.rightMenus)===null||j===void 0?void 0:j.map(function(a,_){return{key:_,label:(0,l.jsx)(D.Z,{body:a})}}),Fe=(0,ie.lr)(),G=m()(Fe,2),N=G[0],Je=G[1];(0,f.useEffect)(function(){if(c&&c.length>0){var a=c.find(function(_){return _.path.startsWith(p.pathname+(N.get("api")?"?api="+N.get("api"):""))});if(!a)return;Ke(a.key)}},[p,c]);var xe=function a(_){return _.reduce(function(e,n){return e.push(n),n.routes&&n.routes.length>0&&(e=e.concat(a(n.routes))),e},[])},ze=function a(_){return _.filter(function(e){return e.routes&&e.routes.length&&(e.routes=a(e.routes)),e.show})};return(0,l.jsx)(ee.ZP,{locale:ae.Z,children:(0,l.jsxs)(te.Z,{children:[(0,l.jsxs)(v.Helmet,{children:[(0,l.jsx)("meta",{charSet:"utf-8"}),(0,l.jsx)("title",{children:De})]}),(o==null?void 0:o.title)&&(0,l.jsx)(se.f,R()(R()({},o),{},{loading:ve,logo:o.logo?o.logo:ue,iconfontUrl:o.iconfontUrl,openKeys:Oe,selectedKeys:x,menuProps:{onOpenChange:ke,onClick:Be},onCollapse:function(_){Ue(_)},menuDataRender:function(){return Ie},actionsRender:function(){return[(0,l.jsx)(D.Z,{body:o.actions},"action")]},avatarProps:{src:d!=null&&d.avatar?d==null?void 0:d.avatar:(0,l.jsx)(oe.Z,{}),size:"small",title:fe.layout==="side"?Ce||d==null?void 0:d.nickname:d==null?void 0:d.nickname,render:function(_,e){return(0,l.jsx)(ne.Z,{menu:{items:Ze},children:e})}},footerRender:function(){return(0,l.jsx)(D.Z,{body:o.footer})},children:W?(0,l.jsx)(D.Z,{body:W}):(0,l.jsx)(v.Outlet,{})}))]})})};L.default=de}}]);
